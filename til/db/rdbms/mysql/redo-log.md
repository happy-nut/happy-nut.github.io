# MySQL redo log

MySQL의 Redo Log 는 장애 복구(Roll Forward)를 위해 사용되는 로그이다.
장애가 발생하더라도 커밋된 트랜잭션 만큼은 절대 잃지 않겠어! 라는 취지로,
ACID의 D(Durability) 를 보장하기 위해 사용되는 것으로 이해하면 된다.

## redo log 쓰기

커밋된 데이터를 디스크에 반드시 써야 하는데, 정상 상황에서 내부 동작 순서는 다음과 같다.

1. 버퍼풀에 데이터 페이지 수정
2. redo log 에 변경사항 기록
3. 클라이언트에게 응답
4. 나중에 실제 데이터 페이지를 디스크에 쓰기 (백그라운드 스레드)

안정성을 우선한다면 3번 과정과 4번 과정을 바꾸도록 설정도 할 수 있다.
갑작스런 시스템 다운 상황에서 백그라운드 스레드가 온전하게 데이터를 디스크에 쓰지 못했다면
데이터가 완전하게 보전되는 것이 아니기 때문에 트레이드 오프가 있는 것이다.

설정은 다음과 같이 할 수 있다.

```sql
SET GLOBAL innodb_flush_log_at_trx_commit = 1; -- 디스크 쓰기 완료까지 대기
SET GLOBAL innodb_flush_log_at_trx_commit = 0; -- 증기 응답 후 나중에 쓰기
```
